<!doctype html><html><head><meta charset="utf-8"><meta http-equiv="Content-Security-Policy" content="default-src * 'self' 'unsafe-inline' 'unsafe-eval' data: blob:"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui,viewport-fit=cover"><meta name="theme-color" content="#007aff"><meta name="format-detection" content="telephone=no"><meta name="msapplication-tap-highlight" content="no"><title>Desktop Editor</title><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><link rel="apple-touch-icon" href="static/icons/apple-touch-icon.png"><link rel="icon" href="static/icons/favicon.png"><style>body {
    margin: 0;
}

body.theme-type-light {
    --background-navbar-ios: #ffffff;
    --background-navbar-word: #446995;
    --background-navbar-cell: #40865c;
    --background-navbar-slide: #BE664F;
}

body.theme-type-dark {
    --background-navbar-ios: #232323;
    --background-navbar-word: #232323;
    --background-navbar-cell: #232323;
    --background-navbar-slide: #232323;
}

.skl-navbar {
    --box-logo-height: 0;
    --skl-navbar-height: 44px;
    --skl-pixel-ratio: 1;
}

.skl-navbar--md {
    --skl-navbar-height: 56px;
}

.skl-pixel-ratio--2 {
    --skl-pixel-ratio: 2;
}

.skl-navbar {
    height: calc(var(--skl-navbar-height) + var(--box-logo-height));
    width: 100%;
    position: relative;
}

.navbar.main-navbar {
    height: 0;
}

.skl-navbar.skl-navbar--md {
    /*height: calc(56px + 26px);*/
}

.skl-navbar.skl-navbar--ios {
    background-color: var(--background-navbar-ios, #f7f7f8);
}

.skl-navbar.skl-navbar--word.skl-navbar--md {
    background-color: var(--background-navbar-word, #446995);
}

.skl-navbar.skl-navbar--cell.skl-navbar--md {
    background-color: var(--background-navbar-cell, #40865c);
}

.skl-navbar.skl-navbar--slide.skl-navbar--md {
    background-color: var(--background-navbar-slide, #BE664F);
}

.skl-navbar::before {
    content: '';
    position: absolute;
    width: 100%;
}

.skl-navbar:not(.skl-navbar--md)::before {
    background-color: rgba(0,0,0,0.25);
    display: block;
    z-index: 15;
    top: auto;
    right: auto;
    bottom: 0;
    left: 0;
    height: 1px;
    transform-origin: 50% 100%;
    transform: scaleY(calc(1 / var(--skl-pixel-ratio)));
}

.skl-navbar.skl-navbar--md::before {
    right: 0;
    width: 100%;
    top: 100%;
    bottom: auto;
    height: 8px;
    pointer-events: none;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0.25) 0%, rgba(0, 0, 0, 0.08) 40%, rgba(0, 0, 0, 0.04) 50%, rgba(0, 0, 0, 0) 90%, rgba(0, 0, 0, 0) 100%)
}

.skl-lines {
    display: none;
}

.skl-line {
    height: 15px;
    margin: 30px;
    background: #e2e2e2;
    overflow: hidden;
    position: relative;
    -webkit-animation: flickerAnimation 2s infinite ease-in-out;
    animation: flickerAnimation 2s infinite ease-in-out;
}

.framework7-initializing .page-content {
    display: none;
}

@keyframes flickerAnimation {
    0%   { opacity:0.1; }
    50%  { opacity:1; }
    100% { opacity:0.1; }
}
@-o-keyframes flickerAnimation{
    0%   { opacity:0.1; }
    50%  { opacity:1; }
    100% { opacity:0.1; }
}
@-moz-keyframes flickerAnimation{
    0%   { opacity:0.1; }
    50%  { opacity:1; }
    100% { opacity:0.1; }
}
@-webkit-keyframes flickerAnimation{
    0%   { opacity:0.1; }
    50%  { opacity:1; }
    100% { opacity:0.1; }
}

.md .navbar.navbar-with-logo {
    height: 34px;
}

.ios .navbar.navbar-with-logo {
    height: 26px;
}

:root .theme-type-dark {
    --f7-navbar-bg-color: #232323;
    --f7-bars-bg-color-rgb: 35,35,35;
    --f7-subnavbar-bg-color: #232323;
    --f7-bars-translucent-opacity: 1;
}

.md .word-editor {
    --f7-navbar-bg-color: var(--background-navbar-word, #446995);
    --f7-subnavbar-bg-color: var(--background-navbar-word, #446995);
    --f7-subnavbar-height: 56px;
}

.md .cell-editor {
    --f7-navbar-bg-color: var(--background-navbar-cell, #40865c);
    --f7-subnavbar-bg-color: var(--background-navbar-cell, #40865c);
    --f7-subnavbar-height: 56px;
}

.md .slide-editor {
    --f7-navbar-bg-color: var(--background-navbar-slide, #BE664F);
    --f7-subnavbar-bg-color: var(--background-navbar-slide, #BE664F);
    --f7-subnavbar-height: 56px;
}</style><script defer="defer" src="dist/js/app.js"></script></head><body><script>window.Common = {Locale: {defaultLang: "en"}};</script><script>window.asceditor = 'word';
        
const load_stylesheet = reflink => {
    let link = document.createElement( "link" );
    link.href = reflink;
    // link.type = "text/css";
    link.rel = "stylesheet";

    document.getElementsByTagName("head")[0].appendChild(link);
};

if(!!window.Android && window.Android.editorConfig) {
    window.native = {editorConfig: window.Android.editorConfig()}
}

function isLocalStorageAvailable() {
    try {
        const testKey = 'test';
        localStorage.setItem(testKey, '1');
        localStorage.removeItem(testKey);

        return true;
    } catch (e) {
        return false;
    }
}

{
    let lang = (/(?:&|^)lang=([^&]+)&?/i).exec(window.location.search.substring(1));
    lang = ((lang && lang[1]) || window.Common.Locale.defaultLang).split(/[\-\_]/)[0];
    Common.Locale.currentLang = lang;
    Common.Locale.isCurrentLangRtl = lang.lastIndexOf('ar', 0) === 0;
}

{
    let modeDirection = 'ltr';
    if ( Common.Locale.isCurrentLangRtl ) {
            modeDirection = (isLocalStorageAvailable() && localStorage.getItem('mobile-mode-direction')) || 'rtl';
    }

    if(modeDirection === 'rtl') {
        load_stylesheet('./css/framework7-rtl.css');
        document.body.classList.add('rtl');
    } else {
        load_stylesheet('./css/framework7.css')
    }
}

let obj = !isLocalStorageAvailable() ? {id: 'theme-light', type: 'light'} : JSON.parse(localStorage.getItem("mobile-ui-theme"));

if ( !obj ) {
    let theme_type = window.native?.editorConfig?.theme?.type;
    if ( !theme_type && window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches )
        theme_type = "dark";

    obj = theme_type == 'dark' ?
        {id: 'theme-dark', type: 'dark'} : {id: 'theme-light', type: 'light'};
    // localStorage && localStorage.setItem("mobile-ui-theme", JSON.stringify(obj));

    if(isLocalStorageAvailable()) {
        localStorage.setItem("mobile-ui-theme", JSON.stringify(obj));
    }
}

document.body.classList.add(`theme-type-${obj.type}`, `${window.asceditor}-editor`);</script><script>/*
 * (c) Copyright Ascensio System SIA 2010-2023
 *
 * This program is a free software product. You can redistribute it and/or
 * modify it under the terms of the GNU Affero General Public License (AGPL)
 * version 3 as published by the Free Software Foundation. In accordance with
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect
 * that Ascensio System SIA expressly excludes the warranty of non-infringement
 * of any third-party rights.
 *
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html
 *
 * You can contact Ascensio System SIA at 20A-6 Ernesta Birznieka-Upish
 * street, Riga, Latvia, EU, LV-1050.
 *
 * The  interactive user interfaces in modified source and object code versions
 * of the Program must display Appropriate Legal Notices, as required under
 * Section 5 of the GNU AGPL version 3.
 *
 * Pursuant to Section 7(b) of the License you must retain the original Product
 * logo when distributing the program. Pursuant to Section 7(e) we decline to
 * grant you any rights under trademark law for use of our trademarks.
 *
 * All the Product's GUI elements, including illustrations and icon sets, as
 * well as technical writing content are licensed under the terms of the
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode
 *
 */
function checkExtendedPDF(directUrl, key, url, token, callback) {
    //110 is not enough for the new PDF form    
    var limit = 300;
    if (directUrl) {
        downloadPartialy(directUrl, limit, null, function(text) {
            callback(isExtendedPDFFile(text))
        });
    } else {
        let postData = JSON.stringify({
            'url': url,
            "token": token
        });
        var handlerUrl = "../../../../downloadfile/"+encodeURIComponent(key);
        downloadPartialy(handlerUrl, limit, postData, function(text) {
            callback(isExtendedPDFFile(text))
        });
    }
}
function isExtendedPDFFile(text) {
    if (!text) {
        return false;
    }
    const indexFirst = text.indexOf('%\xCD\xCA\xD2\xA9\x0D');
    if (indexFirst === -1) {
        return false;
    }

    let pFirst = text.substring(indexFirst + 6);

    if (!(pFirst.lastIndexOf('1 0 obj\x0A<<\x0A', 0) === 0)) {
        return false;
    }

    pFirst = pFirst.substring(11);

    let signature = 'ONLYOFFICEFORM';
    const indexStream = pFirst.indexOf('stream\x0D\x0A');
    const indexMeta = pFirst.indexOf(signature);

    if (indexStream === -1 || indexMeta === -1 || indexStream < indexMeta) {
        return false;
    }

    let pMeta = pFirst.substring(indexMeta);
    pMeta = pMeta.substring(signature.length + 3);

    let indexMetaLast = pMeta.indexOf(' ');
    if (indexMetaLast === -1) {
        return false;
    }

    pMeta = pMeta.substring(indexMetaLast + 1);

    indexMetaLast = pMeta.indexOf(' ');
    if (indexMetaLast === -1) {
        return false;
    }

    return true;
}
function downloadPartialy(url, limit, postData, callback) {
    var callbackCalled = false;
    var xhr = new XMLHttpRequest();
    //value of responseText always has the current content received from the server, even if it's incomplete
    // xhr.responseType = "json"; it raises an IE error. bug 66160
    xhr.overrideMimeType('text/plain; charset=iso-8859-1');
    xhr.onreadystatechange = function () {
        if (callbackCalled) {
            return;
        }
        if (xhr.readyState === 4) {
            callbackCalled = true;
            callback(xhr.responseText);
        } else if (xhr.readyState === 3 && xhr.responseText.length >= limit) {
            callbackCalled = true;
            var res = xhr.responseText;
            xhr.abort();
            callback(res);
        }
    };
    let method = postData ? 'POST' : 'GET';
    xhr.open(method, url, true);
    xhr.setRequestHeader('Range', 'bytes=0-' + limit); // the bytes (incl.) you request
    xhr.send(postData);
}

var startCallback;
var eventFn = function(msg) {
    if (msg.origin !== window.parentOrigin && msg.origin !== window.location.origin && !(msg.origin==="null" && (window.parentOrigin==="file://" || window.location.origin==="file://"))) return;

    var data = msg.data;
    if (Object.prototype.toString.apply(data) !== '[object String]' || !window.JSON) {
        return;
    }
    try {
        data = window.JSON.parse(data)
    } catch(e) {
        data = '';
    }

    if (data && data.command==="checkParams") {
        data = data.data || {};
        checkExtendedPDF(data.directUrl, data.key, data.url, data.token, startCallback);
        _unbindWindowEvents();
    }
};

var _bindWindowEvents = function() {
    if (window.addEventListener) {
        window.addEventListener("message", eventFn, false)
    } else if (window.attachEvent) {
        window.attachEvent("onmessage", eventFn);
    }
};

var _unbindWindowEvents = function() {
    if (window.removeEventListener) {
        window.removeEventListener("message", eventFn)
    } else if (window.detachEvent) {
        window.detachEvent("onmessage", eventFn);
    }
};

function listenApiMsg(callback) {
    startCallback = callback;
    _bindWindowEvents();
}</script><section class="skl-container"><div class="skl-navbar skl-navbar--word"></div><div class="skl-lines"><div class="skl-line"></div><div class="skl-line"></div><div class="skl-line"></div></div></section><script>const isAndroid = /Android/.test(navigator.userAgent);
        if ( isAndroid && navigator.platform == 'Win32' )
            // Framework7 doesn't set Device.android flag when navigator.platform == 'Win32', change it for debug
            navigator.__defineGetter__('platform', () => 'Win32Debug');

        const element_add_class = (el, cls) => (el && el.classList.add(cls));

        let navbar = document.querySelector('.skl-navbar');
        if ( window.devicePixelRatio ) {
            element_add_class(navbar, `skl-pixel-ratio--${Math.floor(window.devicePixelRatio)}`);
        }

        if ( !isAndroid ) {
            const ua = navigator.userAgent;
            const iPad = ua.match(/(iPad).*OS\s([\d_]+)/);
            const iPhone = !iPad && ua.match(/(iPhone\sOS|iOS)\s([\d_]+)/);

            if ( !iPad && !iPhone ) {
                Object.defineProperty(navigator, 'userAgent', {
                    get: function () { return `iPad; CPU OS 11_0 ${ua}`; }
                });
            } else {
                element_add_class(navbar, `skl-navbar--ios`);
            }
        } else {
            element_add_class(navbar, `skl-navbar--md`);
        }

        const getUrlParams = () => {
            let e,
                a = /\+/g,  // Regex for replacing addition symbol with a space
                r = /([^&=]+)=?([^&]*)/g,
                d = s => decodeURIComponent(s.replace(a, " ")),
                q = window.location.search.substring(1),
                urlParams = {};

            while (e = r.exec(q))
                urlParams[d(e[1])] = d(e[2]);

            return urlParams;
        };
        function encodeUrlParam(str) {
            return str.replace(/"/g, '&quot;')
                .replace(/'/g, '&#39;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;');
        }

        let params = getUrlParams();
        window.frameEditorId = params["frameEditorId"];
        window.parentOrigin = params["parentOrigin"];</script><script src="../../../vendor/jquery/jquery.min.js"></script><div id="app"></div></body></html>